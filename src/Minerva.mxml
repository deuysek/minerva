<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
	layout="vertical"
	showStatusBar="false" 
	creationComplete="init()" addedToStage="initTracker()" frameRate= "90" width="960" height="590" verticalGap="0" paddingBottom="10" paddingLeft="10" paddingRight="10" paddingTop="10">
	
	<mx:Style source="style/style.css" />
	
	<mx:Script source="com/coursevector/minerva/Main.as" />
	
	<mx:Fade id="fadeOut" duration="100" alphaFrom="1.0" alphaTo="0.0"/>
    <mx:Fade id="fadeIn" duration="100" alphaFrom="0.0" alphaTo="1.0"/>
	
	<mx:ControlBar width="100%" includeInLayout="true" horizontalAlign="right">
		<mx:ToggleButtonBar id="tbb"
			toggleOnClick="true"
			itemClick="onClickTab(event);" labelField="label" toolTipField="tooltip">
			<mx:dataProvider>
				<mx:Object label="Sol 编辑器" tooltip="Sol 编辑器" index="0"/>
				<mx:Object label="代码格式化" tooltip="代码格式化"  index="1"/>
			</mx:dataProvider>
		</mx:ToggleButtonBar>
		<mx:Spacer width="100%" />
	
		<mx:Button label="打开" click="fileOpen()" includeInLayout="{showOpen}" visible="{showOpen}" icon="@Embed(source='assets/icons/documentOpenIcon.png')" />
		
		<mx:Button label="保存" click="fileSave()" includeInLayout="{showSave}" visible="{showSave}" icon="@Embed(source='assets/icons/saveIcon.png')" />
		<mx:Button label="另存为" click="fileSaveAs()" includeInLayout="{showSave}" visible="{showSave}" icon="@Embed(source='assets/icons/saveAsIcon.png')" />
		<mx:Button label="导出为JSON" click="fileSaveAsJSON()" includeInLayout="{showSave}" visible="{showSave}" icon="@Embed(source='assets/icons/saveAsIcon.png')" />
		<mx:Button label="关闭" click="fileClose()" includeInLayout="{showSave}" visible="{showSave}" />
		<mx:Image source="assets/icons/helpIcon.png" click="onClickAbout()" toolTip="关于" autoLoad="true"/>
	</mx:ControlBar>
	
	<mx:ViewStack 
		id="vsNav"
		creationPolicy="all" 
		selectedIndex="0" 
		width="100%" 
		height="100%">

		<mx:VBox id="canReader"	label="Sol 编辑器" width="100%" height="100%" 
			paddingLeft="10" paddingBottom="10"	paddingRight="10" paddingTop="10" 
			hideEffect="{fadeOut}" showEffect="{fadeIn}">
			
			<mx:HBox width="100%" verticalAlign="middle">
				<mx:HBox width="50%" horizontalAlign="left">
					<mx:Button id="btnInsert" enabled="{hasFile}" toolTip="插入项目" click="onClickInsert()" label="插入项目" labelPlacement="right" />
					<mx:Button id="btnRemove" enabled="{hasFile}" toolTip="删除项目" click="onClickRemove()" label="删除项目" labelPlacement="right" />
				</mx:HBox>
				<mx:HBox width="50%" horizontalAlign="right">
					<mx:Label text="排序方式" />
					<mx:ComboBox id="cbSort" change="onChangeSort(event)" selectedIndex="0" editable="false" >
						<mx:dataProvider>
							<mx:Object label="名称升序" data="name-asc" tooltip="名称升序" />
							<mx:Object label="名称降序" data="name-desc" tooltip="名称降序" />
							<mx:Object label="数据类型升序" data="type-asc" tooltip="数据类型升序" />
							<mx:Object label="数据类型降序" data="type-desc" tooltip="数据类型降序" />
						</mx:dataProvider>
					</mx:ComboBox>
					<mx:Button id="btnRefresh" enabled="{hasFile}" toolTip="重载文件" click="onClickRefresh()" label="刷新" labelPlacement="right" icon="@Embed(source='assets/icons/refresh.png')"/>
				</mx:HBox>
			</mx:HBox>
				
			<mx:HDividedBox width="100%" height="100%" >
				<mx:Tree 
					id="dataTree" 
					dataTipFunction="treeTip" 
					showDataTips="true" 
					editable="{hasFile}" 
					editorXOffset="25" 
					editorYOffset="0"
					doubleClickEnabled="true" 
					useRollOver="true"
					itemRollOver="treeOverHandler(event)"
					itemDoubleClick="treeDoubleClick(event)" 
					itemEditBegin="treeEditBegin(event)"
					itemEditBeginning="treeEditBeginning(event)"
					itemEditEnd="treeEditEnd(event)" 
					keyDown="treeKeyDown(event)"
					change="treeChanged(event)" 
					iconFunction="treeIcon" 
					labelFunction="treeLabel" 
					height="100%" 
					width="75%" />
				
				<mx:ViewStack 
					id="vsType"
					creationPolicy="all"
					visible="{showInspector}" 
					hideEffect="{fadeOut}" 
					showEffect="{fadeIn}" 
					width="100%" 
					height="100%" 
					paddingBottom="10"
					paddingRight="10" 
					paddingTop="10">
					
					<mx:Canvas id="EmptyType" >
						<mx:HBox>
							<mx:Label text="数据类型" />
							<mx:ComboBox dataProvider="{arrDataTypes}" selectedIndex="1" id="ddEmptyType" change="treeValueChanged(event, ddEmptyType.selectedLabel, null)"></mx:ComboBox>
						</mx:HBox>
					</mx:Canvas>
					
					<mx:Canvas id="ObjectType" >
					</mx:Canvas>
					
					<mx:VBox id="NumberType" hideEffect="{fadeOut}" showEffect="{fadeIn}" >
						<mx:TextInput width="100%" id="numberValueInput" change="treeValueChanged(event, 'invalid', numberValueInput.text)" editable="true" />
					</mx:VBox>
					
					<mx:VBox id="BooleanType" hideEffect="{fadeOut}" showEffect="{fadeIn}">
						<mx:HBox width="100%">
							<mx:RadioButton label="True" enabled="true" id="radTrue" groupName="rgBoolean" change="treeValueChanged(event, 'invalid', true)"/>
							<mx:RadioButton label="False" enabled="true" id="radFalse" groupName="rgBoolean" change="treeValueChanged(event, 'invalid', false)"/>
						</mx:HBox>
					</mx:VBox>
					
					<mx:VBox id="StringType" hideEffect="{fadeOut}" showEffect="{fadeIn}">
						<mx:HBox width="100%" horizontalGap="7">
							<mx:Button id="btnBase64Encode" label="Base64编码" click="base64Encode(event, stringValueInput.text)"/>
							<mx:Button id="btnBase64Decode" label="Base64解码" click="base64Decode(event, stringValueInput.text)"/>
							<mx:Button id="btnUriEncode" label="Uri编码" click="uriEncode(event, stringValueInput.text)"/>
							<mx:Button id="btnUriDecode" label="Uri解码" click="uriDecode(event, stringValueInput.text)"/>
						</mx:HBox>
						<mx:TextArea height="100%" width="100%" id="stringValueInput" editable="true" change="treeValueChanged(event, 'invalid', stringValueInput.text)" />
					</mx:VBox>
					
					<mx:VBox id="ByteArrayType" hideEffect="{fadeOut}" showEffect="{fadeIn}">
						<mx:HBox width="100%" horizontalGap="7">
							<mx:Button id="btnCompress" label="Zlib压缩" click="compressByteArray(event, byteValueInput.text)"/>
							<mx:Button id="btnUncompress" label="Zlib解压" click="uncompressByteArray(event, byteValueInput.text)"/>
							<mx:Button id="btnDeflate" label="Deflate压缩" click="deflateByteArray(event, byteValueInput.text)"/>
							<mx:Button id="btnInflate" label="Inflate解压" click="inflateByteArray(event, byteValueInput.text)"/>
						</mx:HBox>
						<mx:VBox height="50%" width="100%">
							<mx:Label text="16进制模式" />
							<mx:TextArea id="byteValueInput" width="100%" height="100%" editable="true" change="treeValueChanged(event, 'invalid', byteValueInput.text)" />
						</mx:VBox>
						<mx:VBox height="50%" width="100%">
							<mx:Label text="字符串格式" />
							<mx:TextArea id="byteValueDisplay" width="100%" height="100%" color="#999999" editable="false"/>
						</mx:VBox>
					</mx:VBox>
					
					<mx:VBox id="DateType" hideEffect="{fadeOut}" showEffect="{fadeIn}">
						<mx:HBox width="100%" horizontalGap="7">
							<mx:Label text="日期:" />
							<mx:DateField id="dateDF" formatString="YYYY/MM/DD" yearNavigationEnabled="true" showToday="true" 
								change="treeValueChanged(event, 'invalid', dateDF.selectedDate, txtHour.text, txtMin.text, txtSec.text)"/>
						</mx:HBox>
						<mx:HBox width="100%">
							<mx:Label text="时间:" />
							<mx:TextInput width="25" id="txtHour" maxChars="2" restrict="0123456789" editable="true" textAlign="center" change="treeValueChanged(event, 'invalid', dateDF.selectedDate, txtHour.text, txtMin.text, txtSec.text)"/>
							<mx:Label text=":" width="10"/>
							<mx:TextInput width="25" id="txtMin" maxChars="2" restrict="0123456789" editable="true" textAlign="center" change="treeValueChanged(event, 'invalid', dateDF.selectedDate, txtHour.text, txtMin.text, txtSec.text)"/>
							<mx:Label text=":" width="10"/>
							<mx:TextInput width="35" id="txtSec" maxChars="3" restrict="0123456789" editable="true" textAlign="right" change="treeValueChanged(event, 'invalid', dateDF.selectedDate, txtHour.text, txtMin.text, txtSec.text)"/>
						</mx:HBox>
					</mx:VBox>
				</mx:ViewStack>
			</mx:HDividedBox>
		</mx:VBox>
		
		<mx:VBox 
			id="canCode"
			label="格式化代码" 
			width="100%" 
			height="100%"
			hideEffect="{fadeOut}" 
			showEffect="{fadeIn}"
			horizontalAlign="center" 
			paddingLeft="10" 
			paddingBottom="10" 
			paddingRight="10" 
			paddingTop="10">
			<mx:HBox width="100%" horizontalAlign="center" verticalAlign="middle">
				<mx:ComboBox id="ddSize" selectedIndex="3" change="updateConfig()">
					 <mx:ArrayCollection>
						 <mx:Object label="缩进类型:Tab" data="1"/>
						 <mx:Object label="缩进类型:2空格" data="2"/>
						 <mx:Object label="缩进类型:3空格" data="3"/>
						 <mx:Object label="缩进类型:4空格" data="4"/>
						 <mx:Object label="缩进类型:8空格" data="8"/>
					 </mx:ArrayCollection>
				</mx:ComboBox>
				<mx:CheckBox id="cbBraces" label="大括号换行" change="updateConfig()"/>
				<mx:CheckBox id="cbPreserve" label="保留空行" selected="true" change="updateConfig()"/>
				<mx:CheckBox id="cbPackers" label="打包器检测" selected="true" change="updateConfig()"/>
				<mx:CheckBox id="cbKeepIndentation" label="保留数组缩进" change="updateConfig()"/>
			</mx:HBox>
			<mx:TextArea 
				width="100%" 
				height="100%" 
				textAlign="left" 
				id="txtCode" 
				horizontalScrollPolicy="auto" 
				wordWrap="false" 
				editable="true" 
				enabled="true"/>
			<mx:Button 
				label="代码格式化(js/json)" 
				click="formatHandler(event)" 
				id="btnFormat" width="100%" height="40"/>
		</mx:VBox>
	</mx:ViewStack>
</mx:WindowedApplication>